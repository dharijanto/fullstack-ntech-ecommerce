"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_controller_1=require("./base-controller");let path=require("path"),passport=require("passport"),log=require("npmlog");const TAG="SearchManagementController";class SearchManagementController extends base_controller_1.default{constructor(e){super(e),this.routeGet("/login",(e,r,s)=>{r.locals.errors=e.flash("error"),r.render("login")}),this.routeGet("/register",(e,r,s)=>{r.locals.errors=e.flash("error"),r.render("register")}),this.routePost("/register",passport.authenticate("app_register",{failureRedirect:"/register",failureFlash:!0}),(e,r,s)=>{r.redirect(e.session&&e.session.returnTo||"/")}),this.routePost("/login",passport.authenticate("app_login",{failureRedirect:"/login",failureFlash:!0}),(e,r,s)=>{log.verbose(TAG,"submitlogin.POST(): redirecting to: "+(e.session&&e.session.returnTo)),r.redirect(e.session&&e.session.returnTo||"/")})}}module.exports=SearchManagementController;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAvY29udHJvbGxlcnMvY3JlZGVudGlhbC1jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbImJhc2VfY29udHJvbGxlcl8xIiwicmVxdWlyZSIsInBhdGgiLCJwYXNzcG9ydCIsImxvZyIsIlRBRyIsIlNlYXJjaE1hbmFnZW1lbnRDb250cm9sbGVyIiwiZGVmYXVsdCIsIltvYmplY3QgT2JqZWN0XSIsImluaXREYXRhIiwic3VwZXIiLCJ0aGlzIiwicm91dGVHZXQiLCJyZXEiLCJyZXMiLCJuZXh0IiwibG9jYWxzIiwiZXJyb3JzIiwiZmxhc2giLCJyZW5kZXIiLCJyb3V0ZVBvc3QiLCJhdXRoZW50aWNhdGUiLCJmYWlsdXJlUmVkaXJlY3QiLCJmYWlsdXJlRmxhc2giLCJyZWRpcmVjdCIsInNlc3Npb24iLCJyZXR1cm5UbyIsInZlcmJvc2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoib0VBQUEsTUFBQUEsa0JBQUFDLFFBQUEscUJBQ0EsSUFBSUMsS0FBT0QsUUFBUSxRQUNmRSxTQUFXRixRQUFRLFlBQ25CRyxJQUFNSCxRQUFRLFVBSWxCLE1BQU1JLElBQU0sbUNBQ1pDLG1DQUF5Q04sa0JBQUFPLFFBQ3ZDQyxZQUFhQyxHQUNYQyxNQUFNRCxHQUVORSxLQUFLQyxTQUFTLFNBQVUsQ0FBQ0MsRUFBS0MsRUFBS0MsS0FDakNELEVBQUlFLE9BQU9DLE9BQVNKLEVBQUlLLE1BQU0sU0FDOUJKLEVBQUlLLE9BQU8sV0FHYlIsS0FBS0MsU0FBUyxZQUFhLENBQUNDLEVBQUtDLEVBQUtDLEtBQ3BDRCxFQUFJRSxPQUFPQyxPQUFTSixFQUFJSyxNQUFNLFNBQzlCSixFQUFJSyxPQUFPLGNBR2JSLEtBQUtTLFVBQVUsWUFBYWpCLFNBQVNrQixhQUFhLGdCQUNoREMsZ0JBQWlCLFlBQ2pCQyxjQUFjLElBQ1osQ0FBQ1YsRUFBS0MsRUFBS0MsS0FDYkQsRUFBSVUsU0FBVVgsRUFBSVksU0FBV1osRUFBSVksUUFBUUMsVUFBYSxPQUd4RGYsS0FBS1MsVUFBVSxTQUFVakIsU0FBU2tCLGFBQWEsYUFDN0NDLGdCQUFpQixTQUNqQkMsY0FBYyxJQUNaLENBQUNWLEVBQUtDLEVBQUtDLEtBQ2JYLElBQUl1QixRQUFRdEIsSUFBSyx3Q0FBMENRLEVBQUlZLFNBQVdaLEVBQUlZLFFBQVFDLFdBQ3RGWixFQUFJVSxTQUFVWCxFQUFJWSxTQUFXWixFQUFJWSxRQUFRQyxVQUFhLFFBTzVERSxPQUFPQyxRQUFVdkIiLCJmaWxlIjoiYXBwL2NvbnRyb2xsZXJzL2NyZWRlbnRpYWwtY29udHJvbGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCYXNlQ29udHJvbGxlciBmcm9tICcuL2Jhc2UtY29udHJvbGxlcidcbmxldCBwYXRoID0gcmVxdWlyZSgncGF0aCcpXG5sZXQgcGFzc3BvcnQgPSByZXF1aXJlKCdwYXNzcG9ydCcpXG5sZXQgbG9nID0gcmVxdWlyZSgnbnBtbG9nJylcblxuLyogdmFyIFBhc3Nwb3J0SGVscGVyID0gcmVxdWlyZShwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4vdXRpbHMvcGFzc3BvcnQtaGVscGVyJykpICovXG5cbmNvbnN0IFRBRyA9ICdTZWFyY2hNYW5hZ2VtZW50Q29udHJvbGxlcidcbmNsYXNzIFNlYXJjaE1hbmFnZW1lbnRDb250cm9sbGVyIGV4dGVuZHMgQmFzZUNvbnRyb2xsZXIge1xuICBjb25zdHJ1Y3RvciAoaW5pdERhdGEpIHtcbiAgICBzdXBlcihpbml0RGF0YSlcblxuICAgIHRoaXMucm91dGVHZXQoJy9sb2dpbicsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgcmVzLmxvY2Fscy5lcnJvcnMgPSByZXEuZmxhc2goJ2Vycm9yJylcbiAgICAgIHJlcy5yZW5kZXIoJ2xvZ2luJylcbiAgICB9KVxuXG4gICAgdGhpcy5yb3V0ZUdldCgnL3JlZ2lzdGVyJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICByZXMubG9jYWxzLmVycm9ycyA9IHJlcS5mbGFzaCgnZXJyb3InKVxuICAgICAgcmVzLnJlbmRlcigncmVnaXN0ZXInKVxuICAgIH0pXG5cbiAgICB0aGlzLnJvdXRlUG9zdCgnL3JlZ2lzdGVyJywgcGFzc3BvcnQuYXV0aGVudGljYXRlKCdhcHBfcmVnaXN0ZXInLCB7XG4gICAgICBmYWlsdXJlUmVkaXJlY3Q6ICcvcmVnaXN0ZXInLFxuICAgICAgZmFpbHVyZUZsYXNoOiB0cnVlXG4gICAgfSksIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgcmVzLnJlZGlyZWN0KChyZXEuc2Vzc2lvbiAmJiByZXEuc2Vzc2lvbi5yZXR1cm5UbykgfHwgJy8nKVxuICAgIH0pXG5cbiAgICB0aGlzLnJvdXRlUG9zdCgnL2xvZ2luJywgcGFzc3BvcnQuYXV0aGVudGljYXRlKCdhcHBfbG9naW4nLCB7XG4gICAgICBmYWlsdXJlUmVkaXJlY3Q6ICcvbG9naW4nLFxuICAgICAgZmFpbHVyZUZsYXNoOiB0cnVlXG4gICAgfSksIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgbG9nLnZlcmJvc2UoVEFHLCAnc3VibWl0bG9naW4uUE9TVCgpOiByZWRpcmVjdGluZyB0bzogJyArIChyZXEuc2Vzc2lvbiAmJiByZXEuc2Vzc2lvbi5yZXR1cm5UbykpXG4gICAgICByZXMucmVkaXJlY3QoKHJlcS5zZXNzaW9uICYmIHJlcS5zZXNzaW9uLnJldHVyblRvKSB8fCAnLycpXG4gICAgfSlcblxuICAgIC8qIHRoaXMucm91dGVHZXQoJy9sb2dvdXQnLCBQYXNzcG9ydEhlbHBlci5sb2dPdXQoKSkgKi9cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFNlYXJjaE1hbmFnZW1lbnRDb250cm9sbGVyXG4iXX0=
