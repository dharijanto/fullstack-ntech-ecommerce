"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_controller_1=require("./base-controller");var path=require("path"),passport=require("passport"),log=require("npmlog");const TAG="SearchManagementController";class SearchManagementController extends base_controller_1.default{constructor(e){super(e),this.routeGet("/login",(e,r,s)=>{r.locals.errors=e.flash("error"),r.render("login")}),this.routeGet("/register",(e,r,s)=>{r.locals.errors=e.flash("error"),r.render("register")}),this.routePost("/register",passport.authenticate("app_register",{failureRedirect:"/register",failureFlash:!0}),(e,r,s)=>{r.redirect(e.session&&e.session.returnTo||"/")}),this.routePost("/login",passport.authenticate("app_login",{failureRedirect:"/login",failureFlash:!0}),(e,r,s)=>{log.verbose(TAG,"submitlogin.POST(): redirecting to: "+(e.session&&e.session.returnTo)),r.redirect(e.session&&e.session.returnTo||"/")})}}module.exports=SearchManagementController;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAvY29udHJvbGxlcnMvY3JlZGVudGlhbC1jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbImJhc2VfY29udHJvbGxlcl8xIiwicmVxdWlyZSIsInBhdGgiLCJwYXNzcG9ydCIsImxvZyIsIlRBRyIsIlNlYXJjaE1hbmFnZW1lbnRDb250cm9sbGVyIiwiZGVmYXVsdCIsIltvYmplY3QgT2JqZWN0XSIsImluaXREYXRhIiwic3VwZXIiLCJ0aGlzIiwicm91dGVHZXQiLCJyZXEiLCJyZXMiLCJuZXh0IiwibG9jYWxzIiwiZXJyb3JzIiwiZmxhc2giLCJyZW5kZXIiLCJyb3V0ZVBvc3QiLCJhdXRoZW50aWNhdGUiLCJmYWlsdXJlUmVkaXJlY3QiLCJmYWlsdXJlRmxhc2giLCJyZWRpcmVjdCIsInNlc3Npb24iLCJyZXR1cm5UbyIsInZlcmJvc2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoib0VBQUEsTUFBQUEsa0JBQUFDLFFBQUEscUJBQ0EsSUFBSUMsS0FBT0QsUUFBUSxRQUVmRSxTQUFXRixRQUFRLFlBQ25CRyxJQUFNSCxRQUFRLFVBSWxCLE1BQU1JLElBQU0sbUNBQ1pDLG1DQUF5Q04sa0JBQUFPLFFBQ3ZDQyxZQUFhQyxHQUNYQyxNQUFNRCxHQUVORSxLQUFLQyxTQUFTLFNBQVUsQ0FBQ0MsRUFBS0MsRUFBS0MsS0FDakNELEVBQUlFLE9BQU9DLE9BQVNKLEVBQUlLLE1BQU0sU0FDOUJKLEVBQUlLLE9BQU8sV0FHYlIsS0FBS0MsU0FBUyxZQUFhLENBQUNDLEVBQUtDLEVBQUtDLEtBQ3BDRCxFQUFJRSxPQUFPQyxPQUFTSixFQUFJSyxNQUFNLFNBQzlCSixFQUFJSyxPQUFPLGNBR2JSLEtBQUtTLFVBQVUsWUFBYWpCLFNBQVNrQixhQUFhLGdCQUNoREMsZ0JBQWlCLFlBQ2pCQyxjQUFjLElBQ1osQ0FBQ1YsRUFBS0MsRUFBS0MsS0FDYkQsRUFBSVUsU0FBVVgsRUFBSVksU0FBV1osRUFBSVksUUFBUUMsVUFBYSxPQUd4RGYsS0FBS1MsVUFBVSxTQUFVakIsU0FBU2tCLGFBQWEsYUFDN0NDLGdCQUFpQixTQUNqQkMsY0FBYyxJQUNaLENBQUNWLEVBQUtDLEVBQUtDLEtBQ2JYLElBQUl1QixRQUFRdEIsSUFBSyx3Q0FBMENRLEVBQUlZLFNBQVdaLEVBQUlZLFFBQVFDLFdBQ3RGWixFQUFJVSxTQUFVWCxFQUFJWSxTQUFXWixFQUFJWSxRQUFRQyxVQUFhLFFBTzVERSxPQUFPQyxRQUFVdkIiLCJmaWxlIjoiYXBwL2NvbnRyb2xsZXJzL2NyZWRlbnRpYWwtY29udHJvbGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCYXNlQ29udHJvbGxlciBmcm9tICcuL2Jhc2UtY29udHJvbGxlcidcbnZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpXG5cbnZhciBwYXNzcG9ydCA9IHJlcXVpcmUoJ3Bhc3Nwb3J0JylcbnZhciBsb2cgPSByZXF1aXJlKCducG1sb2cnKVxuXG4vKiB2YXIgUGFzc3BvcnRIZWxwZXIgPSByZXF1aXJlKHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi91dGlscy9wYXNzcG9ydC1oZWxwZXInKSkgKi9cblxuY29uc3QgVEFHID0gJ1NlYXJjaE1hbmFnZW1lbnRDb250cm9sbGVyJ1xuY2xhc3MgU2VhcmNoTWFuYWdlbWVudENvbnRyb2xsZXIgZXh0ZW5kcyBCYXNlQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yIChpbml0RGF0YSkge1xuICAgIHN1cGVyKGluaXREYXRhKVxuXG4gICAgdGhpcy5yb3V0ZUdldCgnL2xvZ2luJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICByZXMubG9jYWxzLmVycm9ycyA9IHJlcS5mbGFzaCgnZXJyb3InKVxuICAgICAgcmVzLnJlbmRlcignbG9naW4nKVxuICAgIH0pXG5cbiAgICB0aGlzLnJvdXRlR2V0KCcvcmVnaXN0ZXInLCAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIHJlcy5sb2NhbHMuZXJyb3JzID0gcmVxLmZsYXNoKCdlcnJvcicpXG4gICAgICByZXMucmVuZGVyKCdyZWdpc3RlcicpXG4gICAgfSlcblxuICAgIHRoaXMucm91dGVQb3N0KCcvcmVnaXN0ZXInLCBwYXNzcG9ydC5hdXRoZW50aWNhdGUoJ2FwcF9yZWdpc3RlcicsIHtcbiAgICAgIGZhaWx1cmVSZWRpcmVjdDogJy9yZWdpc3RlcicsXG4gICAgICBmYWlsdXJlRmxhc2g6IHRydWVcbiAgICB9KSwgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICByZXMucmVkaXJlY3QoKHJlcS5zZXNzaW9uICYmIHJlcS5zZXNzaW9uLnJldHVyblRvKSB8fCAnLycpXG4gICAgfSlcblxuICAgIHRoaXMucm91dGVQb3N0KCcvbG9naW4nLCBwYXNzcG9ydC5hdXRoZW50aWNhdGUoJ2FwcF9sb2dpbicsIHtcbiAgICAgIGZhaWx1cmVSZWRpcmVjdDogJy9sb2dpbicsXG4gICAgICBmYWlsdXJlRmxhc2g6IHRydWVcbiAgICB9KSwgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBsb2cudmVyYm9zZShUQUcsICdzdWJtaXRsb2dpbi5QT1NUKCk6IHJlZGlyZWN0aW5nIHRvOiAnICsgKHJlcS5zZXNzaW9uICYmIHJlcS5zZXNzaW9uLnJldHVyblRvKSlcbiAgICAgIHJlcy5yZWRpcmVjdCgocmVxLnNlc3Npb24gJiYgcmVxLnNlc3Npb24ucmV0dXJuVG8pIHx8ICcvJylcbiAgICB9KVxuXG4gICAgLyogdGhpcy5yb3V0ZUdldCgnL2xvZ291dCcsIFBhc3Nwb3J0SGVscGVyLmxvZ091dCgpKSAqL1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gU2VhcmNoTWFuYWdlbWVudENvbnRyb2xsZXJcbiJdfQ==
