"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_controller_1=require("../base-controller"),local_shop_service_1=require("../../local-shop-services/local-shop-service"),path=require("path");let log=require("npmlog");const TAG="MainController";class ProductManagementController extends base_controller_1.default{constructor(e){super(Object.assign(e,{viewPath:path.join(__dirname,"../../views")})),super.routeGet("/",(e,r,o)=>{r.render("cms/product-management")}),super.routeGet("/products",(e,r,o)=>{local_shop_service_1.default.getShopifiedProducts().then(r.json.bind(r)).catch(o)}),super.routePost("/product/edit",(e,r,o)=>{const t=e.body.id,s={price:e.body.shopPrice,preOrderAllowed:e.body.preOrderAllowed,preOrderDuration:e.body.preOrderDuration,disabled:e.body.disabled};local_shop_service_1.default.updateProduct(t,s).then(r.json.bind(r)).catch(o)}),super.routeGet("/variants",(e,r,o)=>{const t=e.query.productId;local_shop_service_1.default.getShopifiedVariants(t).then(r.json.bind(r)).catch(o)})}}exports.default=ProductManagementController;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAvY29udHJvbGxlcnMvY21zL3Byb2R1Y3QtbWFuYWdlbWVudC1jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbImJhc2VfY29udHJvbGxlcl8xIiwicmVxdWlyZSIsImxvY2FsX3Nob3Bfc2VydmljZV8xIiwicGF0aCIsImxvZyIsIlRBRyIsIlByb2R1Y3RNYW5hZ2VtZW50Q29udHJvbGxlciIsImRlZmF1bHQiLCJbb2JqZWN0IE9iamVjdF0iLCJzaXRlRGF0YSIsInN1cGVyIiwiT2JqZWN0IiwiYXNzaWduIiwidmlld1BhdGgiLCJqb2luIiwiX19kaXJuYW1lIiwicm91dGVHZXQiLCJyZXEiLCJyZXMiLCJuZXh0IiwicmVuZGVyIiwiZ2V0U2hvcGlmaWVkUHJvZHVjdHMiLCJ0aGVuIiwianNvbiIsImJpbmQiLCJjYXRjaCIsInJvdXRlUG9zdCIsInByb2R1Y3RJZCIsImJvZHkiLCJpZCIsImRhdGEiLCJwcmljZSIsInByZU9yZGVyQWxsb3dlZCIsInByZU9yZGVyRHVyYXRpb24iLCJkaXNhYmxlZCIsInVwZGF0ZVByb2R1Y3QiLCJxdWVyeSIsImdldFNob3BpZmllZFZhcmlhbnRzIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Im9FQUlBLE1BQUFBLGtCQUFBQyxRQUFBLHNCQUVBQyxxQkFBQUQsUUFBQSxnREFLTUUsS0FBT0YsUUFBUSxRQUVyQixJQUFJRyxJQUFNSCxRQUFRLFVBRWxCLE1BQU1JLElBQU0sdUJBS1pDLG9DQUF5RE4sa0JBQUFPLFFBQ3ZEQyxZQUFhQyxHQUNYQyxNQUFNQyxPQUFPQyxPQUFPSCxHQUFZSSxTQUFVVixLQUFLVyxLQUFLQyxVQUFXLGtCQUUvREwsTUFBTU0sU0FBUyxJQUFLLENBQUNDLEVBQUtDLEVBQUtDLEtBQzdCRCxFQUFJRSxPQUFPLDRCQUdiVixNQUFNTSxTQUFTLFlBQWEsQ0FBQ0MsRUFBS0MsRUFBS0MsS0FDckNqQixxQkFBQUssUUFBaUJjLHVCQUF1QkMsS0FBS0osRUFBSUssS0FBS0MsS0FBS04sSUFBTU8sTUFBTU4sS0FHekVULE1BQU1nQixVQUFVLGdCQUFpQixDQUFDVCxFQUFLQyxFQUFLQyxLQUMxQyxNQUFNUSxFQUFZVixFQUFJVyxLQUFLQyxHQUNyQkMsR0FDSkMsTUFBT2QsRUFBSVcsS0FBZ0IsVUFDM0JJLGdCQUFpQmYsRUFBSVcsS0FBc0IsZ0JBQzNDSyxpQkFBa0JoQixFQUFJVyxLQUF1QixpQkFDN0NNLFNBQVVqQixFQUFJVyxLQUFlLFVBRy9CMUIscUJBQUFLLFFBQWlCNEIsY0FBY1IsRUFBV0csR0FBTVIsS0FBS0osRUFBSUssS0FBS0MsS0FBS04sSUFBTU8sTUFBTU4sS0FHakZULE1BQU1NLFNBQVMsWUFBYSxDQUFDQyxFQUFLQyxFQUFLQyxLQUNyQyxNQUFNUSxFQUFZVixFQUFJbUIsTUFBTVQsVUFDNUJ6QixxQkFBQUssUUFBaUI4QixxQkFBcUJWLEdBQVdMLEtBQUtKLEVBQUlLLEtBQUtDLEtBQUtOLElBQU1PLE1BQU1OLE1BMUJ0Rm1CLFFBQUEvQixRQUFBRCIsImZpbGUiOiJhcHAvY29udHJvbGxlcnMvY21zL3Byb2R1Y3QtbWFuYWdlbWVudC1jb250cm9sbGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZXhwcmVzcyBmcm9tICdleHByZXNzJ1xuaW1wb3J0ICogYXMgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcbmltcG9ydCAqIGFzIHB1ZyBmcm9tICdwdWcnXG5cbmltcG9ydCBCYXNlQ29udHJvbGxlciBmcm9tICcuLi9iYXNlLWNvbnRyb2xsZXInXG5pbXBvcnQgU2hvcFNlcnZpY2UgZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvc2hvcC1zZXJ2aWNlJ1xuaW1wb3J0IExvY2FsU2hvcFNlcnZpY2UgZnJvbSAnLi4vLi4vbG9jYWwtc2hvcC1zZXJ2aWNlcy9sb2NhbC1zaG9wLXNlcnZpY2UnXG5pbXBvcnQgeyBTaXRlRGF0YSB9IGZyb20gJy4uLy4uLy4uL3NpdGUtZGVmaW5pdGlvbnMnXG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tICcuLi8uLi8uLi9saWJzL3V0aWxzJ1xuaW1wb3J0IE9yZGVyU2VydmljZSBmcm9tICcuLi8uLi9sb2NhbC1zaG9wLXNlcnZpY2VzL29yZGVyLXNlcnZpY2UnXG5cbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJylcblxubGV0IGxvZyA9IHJlcXVpcmUoJ25wbWxvZycpXG5cbmNvbnN0IFRBRyA9ICdNYWluQ29udHJvbGxlcidcblxuLypcblRPRE86IE9ubHkgdXNlciB3aXRoIGFkbWluIHByaXZpbGVnZSBjYW4gYWNjZXNzIHRoaXMgcGFnZSFcbiovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9kdWN0TWFuYWdlbWVudENvbnRyb2xsZXIgZXh0ZW5kcyBCYXNlQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yIChzaXRlRGF0YTogU2l0ZURhdGEpIHtcbiAgICBzdXBlcihPYmplY3QuYXNzaWduKHNpdGVEYXRhLCB7IHZpZXdQYXRoOiBwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4vLi4vdmlld3MnKSB9KSlcblxuICAgIHN1cGVyLnJvdXRlR2V0KCcvJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICByZXMucmVuZGVyKCdjbXMvcHJvZHVjdC1tYW5hZ2VtZW50JylcbiAgICB9KVxuXG4gICAgc3VwZXIucm91dGVHZXQoJy9wcm9kdWN0cycsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgTG9jYWxTaG9wU2VydmljZS5nZXRTaG9waWZpZWRQcm9kdWN0cygpLnRoZW4ocmVzLmpzb24uYmluZChyZXMpKS5jYXRjaChuZXh0KVxuICAgIH0pXG5cbiAgICBzdXBlci5yb3V0ZVBvc3QoJy9wcm9kdWN0L2VkaXQnLCAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHByb2R1Y3RJZCA9IHJlcS5ib2R5LmlkXG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBwcmljZTogcmVxLmJvZHlbJ3Nob3BQcmljZSddLFxuICAgICAgICBwcmVPcmRlckFsbG93ZWQ6IHJlcS5ib2R5WydwcmVPcmRlckFsbG93ZWQnXSxcbiAgICAgICAgcHJlT3JkZXJEdXJhdGlvbjogcmVxLmJvZHlbJ3ByZU9yZGVyRHVyYXRpb24nXSxcbiAgICAgICAgZGlzYWJsZWQ6IHJlcS5ib2R5WydkaXNhYmxlZCddXG4gICAgICB9XG5cbiAgICAgIExvY2FsU2hvcFNlcnZpY2UudXBkYXRlUHJvZHVjdChwcm9kdWN0SWQsIGRhdGEpLnRoZW4ocmVzLmpzb24uYmluZChyZXMpKS5jYXRjaChuZXh0KVxuICAgIH0pXG5cbiAgICBzdXBlci5yb3V0ZUdldCgnL3ZhcmlhbnRzJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCBwcm9kdWN0SWQgPSByZXEucXVlcnkucHJvZHVjdElkXG4gICAgICBMb2NhbFNob3BTZXJ2aWNlLmdldFNob3BpZmllZFZhcmlhbnRzKHByb2R1Y3RJZCkudGhlbihyZXMuanNvbi5iaW5kKHJlcykpLmNhdGNoKG5leHQpXG4gICAgfSlcbiAgfVxufVxuIl19
