"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_controller_1=require("./base-controller"),order_management_controller_1=require("./cms/order-management-controller"),product_management_controller_1=require("./cms/product-management-controller"),promotion_management_controller_1=require("./cms/promotion-management-controller"),local_shop_service_1=require("../../services/local-shop-service"),path=require("path");let log=require("npmlog");const TAG="MainController";class CMSController extends base_controller_1.default{constructor(e){super(Object.assign(e,{viewPath:path.join(__dirname,"../views")})),super.routeGet("/",(e,r,t)=>{r.redirect("/cms/order-management")}),super.routeGet("/price-list",(e,r,t)=>{local_shop_service_1.default.getProductsByCategories().then(e=>{e.status&&e.data?(console.log(JSON.stringify(e.data,null,2)),r.locals.lastUpdated=e.data.lastUpdated,r.locals.categories=e.data.categories,r.render("cms/price-list")):t(new Error(e.errMessage))})}),super.routeUse("/order-management",new order_management_controller_1.default(e).getRouter()),super.routeUse("/product-management",new product_management_controller_1.default(e).getRouter()),super.routeUse("/promotion-management",new promotion_management_controller_1.default(e).getRouter())}}exports.default=CMSController;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAvY29udHJvbGxlcnMvY21zLWNvbnRyb2xsZXIudHMiXSwibmFtZXMiOlsiYmFzZV9jb250cm9sbGVyXzEiLCJyZXF1aXJlIiwib3JkZXJfbWFuYWdlbWVudF9jb250cm9sbGVyXzEiLCJwcm9kdWN0X21hbmFnZW1lbnRfY29udHJvbGxlcl8xIiwicHJvbW90aW9uX21hbmFnZW1lbnRfY29udHJvbGxlcl8xIiwibG9jYWxfc2hvcF9zZXJ2aWNlXzEiLCJwYXRoIiwibG9nIiwiVEFHIiwiQ01TQ29udHJvbGxlciIsImRlZmF1bHQiLCJbb2JqZWN0IE9iamVjdF0iLCJzaXRlRGF0YSIsInN1cGVyIiwiT2JqZWN0IiwiYXNzaWduIiwidmlld1BhdGgiLCJqb2luIiwiX19kaXJuYW1lIiwicm91dGVHZXQiLCJyZXEiLCJyZXMiLCJuZXh0IiwicmVkaXJlY3QiLCJnZXRQcm9kdWN0c0J5Q2F0ZWdvcmllcyIsInRoZW4iLCJyZXNwIiwic3RhdHVzIiwiZGF0YSIsImNvbnNvbGUiLCJKU09OIiwic3RyaW5naWZ5IiwibG9jYWxzIiwibGFzdFVwZGF0ZWQiLCJjYXRlZ29yaWVzIiwicmVuZGVyIiwiRXJyb3IiLCJlcnJNZXNzYWdlIiwicm91dGVVc2UiLCJnZXRSb3V0ZXIiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoib0VBSUEsTUFBQUEsa0JBQUFDLFFBQUEscUJBRUFDLDhCQUFBRCxRQUFBLHFDQUNBRSxnQ0FBQUYsUUFBQSx1Q0FDQUcsa0NBQUFILFFBQUEseUNBR0FJLHFCQUFBSixRQUFBLHFDQUVNSyxLQUFPTCxRQUFRLFFBRXJCLElBQUlNLElBQU1OLFFBQVEsVUFFbEIsTUFBTU8sSUFBTSx1QkFFWkMsc0JBQTJDVCxrQkFBQVUsUUFDekNDLFlBQWFDLEdBQ1hDLE1BQU1DLE9BQU9DLE9BQU9ILEdBQVlJLFNBQVVWLEtBQUtXLEtBQUtDLFVBQVcsZUFFL0RMLE1BQU1NLFNBQVMsSUFBSyxDQUFDQyxFQUFLQyxFQUFLQyxLQUM3QkQsRUFBSUUsU0FBUywyQkFHZlYsTUFBTU0sU0FBUyxjQUFlLENBQUNDLEVBQUtDLEVBQUtDLEtBQ3ZDakIscUJBQUFLLFFBQWlCYywwQkFBMEJDLEtBQUtDLElBQzFDQSxFQUFLQyxRQUFVRCxFQUFLRSxNQUN0QkMsUUFBUXRCLElBQUl1QixLQUFLQyxVQUFVTCxFQUFLRSxLQUFNLEtBQU0sSUFDNUNQLEVBQUlXLE9BQU9DLFlBQWNQLEVBQUtFLEtBQUtLLFlBQ25DWixFQUFJVyxPQUFPRSxXQUFhUixFQUFLRSxLQUFLTSxXQUNsQ2IsRUFBSWMsT0FBTyxtQkFFWGIsRUFBSyxJQUFJYyxNQUFNVixFQUFLVyxpQkFLMUJ4QixNQUFNeUIsU0FBUyxvQkFBcUIsSUFBSXBDLDhCQUFBUSxRQUEwQkUsR0FBVTJCLGFBQzVFMUIsTUFBTXlCLFNBQVMsc0JBQXVCLElBQUluQyxnQ0FBQU8sUUFBNEJFLEdBQVUyQixhQUNoRjFCLE1BQU15QixTQUFTLHdCQUF5QixJQUFJbEMsa0NBQUFNLFFBQThCRSxHQUFVMkIsY0F2QnhGQyxRQUFBOUIsUUFBQUQiLCJmaWxlIjoiYXBwL2NvbnRyb2xsZXJzL2Ntcy1jb250cm9sbGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZXhwcmVzcyBmcm9tICdleHByZXNzJ1xuaW1wb3J0IEFwcENvbmZpZyBmcm9tICcuLi8uLi9hcHAtY29uZmlnJ1xuaW1wb3J0ICogYXMgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcblxuaW1wb3J0IEJhc2VDb250cm9sbGVyIGZyb20gJy4vYmFzZS1jb250cm9sbGVyJ1xuaW1wb3J0IENhcnRTZXJ2aWNlIGZyb20gJy4uLy4uL3NlcnZpY2VzL2NhcnQtc2VydmljZSdcbmltcG9ydCBPcmRlck1hbmFnZW1lbnRDb250cm9sbGVyIGZyb20gJy4vY21zL29yZGVyLW1hbmFnZW1lbnQtY29udHJvbGxlcidcbmltcG9ydCBQcm9kdWN0TWFuYWdlbWVudENvbnRyb2xsZXIgZnJvbSAnLi9jbXMvcHJvZHVjdC1tYW5hZ2VtZW50LWNvbnRyb2xsZXInXG5pbXBvcnQgUHJvbW90aW9uTWFuYWdlbWVudENvbnRyb2xsZXIgZnJvbSAnLi9jbXMvcHJvbW90aW9uLW1hbmFnZW1lbnQtY29udHJvbGxlcidcbmltcG9ydCB7IFNpdGVEYXRhIH0gZnJvbSAnLi4vLi4vc2l0ZS1kZWZpbml0aW9ucydcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4uLy4uL2xpYnMvdXRpbHMnXG5pbXBvcnQgTG9jYWxTaG9wU2VydmljZSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9sb2NhbC1zaG9wLXNlcnZpY2UnXG5cbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJylcblxubGV0IGxvZyA9IHJlcXVpcmUoJ25wbWxvZycpXG5cbmNvbnN0IFRBRyA9ICdNYWluQ29udHJvbGxlcidcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ01TQ29udHJvbGxlciBleHRlbmRzIEJhc2VDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IgKHNpdGVEYXRhOiBTaXRlRGF0YSkge1xuICAgIHN1cGVyKE9iamVjdC5hc3NpZ24oc2l0ZURhdGEsIHsgdmlld1BhdGg6IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi92aWV3cycpIH0pKVxuXG4gICAgc3VwZXIucm91dGVHZXQoJy8nLCAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIHJlcy5yZWRpcmVjdCgnL2Ntcy9vcmRlci1tYW5hZ2VtZW50JylcbiAgICB9KVxuXG4gICAgc3VwZXIucm91dGVHZXQoJy9wcmljZS1saXN0JywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBMb2NhbFNob3BTZXJ2aWNlLmdldFByb2R1Y3RzQnlDYXRlZ29yaWVzKCkudGhlbihyZXNwID0+IHtcbiAgICAgICAgaWYgKHJlc3Auc3RhdHVzICYmIHJlc3AuZGF0YSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlc3AuZGF0YSwgbnVsbCwgMikpXG4gICAgICAgICAgcmVzLmxvY2Fscy5sYXN0VXBkYXRlZCA9IHJlc3AuZGF0YS5sYXN0VXBkYXRlZFxuICAgICAgICAgIHJlcy5sb2NhbHMuY2F0ZWdvcmllcyA9IHJlc3AuZGF0YS5jYXRlZ29yaWVzXG4gICAgICAgICAgcmVzLnJlbmRlcignY21zL3ByaWNlLWxpc3QnKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5leHQobmV3IEVycm9yKHJlc3AuZXJyTWVzc2FnZSkpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSlcblxuICAgIHN1cGVyLnJvdXRlVXNlKCcvb3JkZXItbWFuYWdlbWVudCcsIG5ldyBPcmRlck1hbmFnZW1lbnRDb250cm9sbGVyKHNpdGVEYXRhKS5nZXRSb3V0ZXIoKSlcbiAgICBzdXBlci5yb3V0ZVVzZSgnL3Byb2R1Y3QtbWFuYWdlbWVudCcsIG5ldyBQcm9kdWN0TWFuYWdlbWVudENvbnRyb2xsZXIoc2l0ZURhdGEpLmdldFJvdXRlcigpKVxuICAgIHN1cGVyLnJvdXRlVXNlKCcvcHJvbW90aW9uLW1hbmFnZW1lbnQnLCBuZXcgUHJvbW90aW9uTWFuYWdlbWVudENvbnRyb2xsZXIoc2l0ZURhdGEpLmdldFJvdXRlcigpKVxuICB9XG59XG4iXX0=
