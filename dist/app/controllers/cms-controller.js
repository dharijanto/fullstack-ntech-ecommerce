"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_controller_1=require("./base-controller"),order_management_controller_1=require("./cms/order-management-controller"),product_management_controller_1=require("./cms/product-management-controller"),promotion_management_controller_1=require("./cms/promotion-management-controller"),stock_management_controller_1=require("./cms/stock-management-controller"),local_shop_service_1=require("../local-shop-services/local-shop-service"),path=require("path");let log=require("npmlog");const TAG="MainController";class CMSController extends base_controller_1.default{constructor(e){super(Object.assign(e,{viewPath:path.join(__dirname,"../views")})),super.routeGet("/",(e,r,t)=>{r.redirect("/cms/order-management")}),super.routeGet("/price-list",(e,r,t)=>{local_shop_service_1.default.getProductsByCategories().then(e=>{e.status&&e.data?(console.log(JSON.stringify(e.data,null,2)),r.locals.lastUpdated=e.data.lastUpdated,r.locals.categories=e.data.categories,r.render("cms/price-list")):t(new Error(e.errMessage))})}),super.routeUse("/order-management",new order_management_controller_1.default(e).getRouter()),super.routeUse("/product-management",new product_management_controller_1.default(e).getRouter()),super.routeUse("/promotion-management",new promotion_management_controller_1.default(e).getRouter()),super.routeUse("/stock-management",new stock_management_controller_1.default(e).getRouter())}}exports.default=CMSController;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAvY29udHJvbGxlcnMvY21zLWNvbnRyb2xsZXIudHMiXSwibmFtZXMiOlsiYmFzZV9jb250cm9sbGVyXzEiLCJyZXF1aXJlIiwib3JkZXJfbWFuYWdlbWVudF9jb250cm9sbGVyXzEiLCJwcm9kdWN0X21hbmFnZW1lbnRfY29udHJvbGxlcl8xIiwicHJvbW90aW9uX21hbmFnZW1lbnRfY29udHJvbGxlcl8xIiwic3RvY2tfbWFuYWdlbWVudF9jb250cm9sbGVyXzEiLCJsb2NhbF9zaG9wX3NlcnZpY2VfMSIsInBhdGgiLCJsb2ciLCJUQUciLCJDTVNDb250cm9sbGVyIiwiZGVmYXVsdCIsIltvYmplY3QgT2JqZWN0XSIsInNpdGVEYXRhIiwic3VwZXIiLCJPYmplY3QiLCJhc3NpZ24iLCJ2aWV3UGF0aCIsImpvaW4iLCJfX2Rpcm5hbWUiLCJyb3V0ZUdldCIsInJlcSIsInJlcyIsIm5leHQiLCJyZWRpcmVjdCIsImdldFByb2R1Y3RzQnlDYXRlZ29yaWVzIiwidGhlbiIsInJlc3AiLCJzdGF0dXMiLCJkYXRhIiwiY29uc29sZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJsb2NhbHMiLCJsYXN0VXBkYXRlZCIsImNhdGVnb3JpZXMiLCJyZW5kZXIiLCJFcnJvciIsImVyck1lc3NhZ2UiLCJyb3V0ZVVzZSIsImdldFJvdXRlciIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJvRUFJQSxNQUFBQSxrQkFBQUMsUUFBQSxxQkFFQUMsOEJBQUFELFFBQUEscUNBQ0FFLGdDQUFBRixRQUFBLHVDQUNBRyxrQ0FBQUgsUUFBQSx5Q0FDQUksOEJBQUFKLFFBQUEscUNBR0FLLHFCQUFBTCxRQUFBLDZDQUVNTSxLQUFPTixRQUFRLFFBRXJCLElBQUlPLElBQU1QLFFBQVEsVUFFbEIsTUFBTVEsSUFBTSx1QkFFWkMsc0JBQTJDVixrQkFBQVcsUUFDekNDLFlBQWFDLEdBQ1hDLE1BQU1DLE9BQU9DLE9BQU9ILEdBQVlJLFNBQVVWLEtBQUtXLEtBQUtDLFVBQVcsZUFFL0RMLE1BQU1NLFNBQVMsSUFBSyxDQUFDQyxFQUFLQyxFQUFLQyxLQUM3QkQsRUFBSUUsU0FBUywyQkFHZlYsTUFBTU0sU0FBUyxjQUFlLENBQUNDLEVBQUtDLEVBQUtDLEtBQ3ZDakIscUJBQUFLLFFBQWlCYywwQkFBMEJDLEtBQUtDLElBQzFDQSxFQUFLQyxRQUFVRCxFQUFLRSxNQUN0QkMsUUFBUXRCLElBQUl1QixLQUFLQyxVQUFVTCxFQUFLRSxLQUFNLEtBQU0sSUFDNUNQLEVBQUlXLE9BQU9DLFlBQWNQLEVBQUtFLEtBQUtLLFlBQ25DWixFQUFJVyxPQUFPRSxXQUFhUixFQUFLRSxLQUFLTSxXQUNsQ2IsRUFBSWMsT0FBTyxtQkFFWGIsRUFBSyxJQUFJYyxNQUFNVixFQUFLVyxpQkFLMUJ4QixNQUFNeUIsU0FBUyxvQkFBcUIsSUFBSXJDLDhCQUFBUyxRQUEwQkUsR0FBVTJCLGFBQzVFMUIsTUFBTXlCLFNBQVMsc0JBQXVCLElBQUlwQyxnQ0FBQVEsUUFBNEJFLEdBQVUyQixhQUNoRjFCLE1BQU15QixTQUFTLHdCQUF5QixJQUFJbkMsa0NBQUFPLFFBQThCRSxHQUFVMkIsYUFDcEYxQixNQUFNeUIsU0FBUyxvQkFBcUIsSUFBSWxDLDhCQUFBTSxRQUEwQkUsR0FBVTJCLGNBeEJoRkMsUUFBQTlCLFFBQUFEIiwiZmlsZSI6ImFwcC9jb250cm9sbGVycy9jbXMtY29udHJvbGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGV4cHJlc3MgZnJvbSAnZXhwcmVzcydcbmltcG9ydCBBcHBDb25maWcgZnJvbSAnLi4vLi4vYXBwLWNvbmZpZydcbmltcG9ydCAqIGFzIFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5cbmltcG9ydCBCYXNlQ29udHJvbGxlciBmcm9tICcuL2Jhc2UtY29udHJvbGxlcidcbmltcG9ydCBDYXJ0U2VydmljZSBmcm9tICcuLi9sb2NhbC1zaG9wLXNlcnZpY2VzL2NhcnQtc2VydmljZSdcbmltcG9ydCBPcmRlck1hbmFnZW1lbnRDb250cm9sbGVyIGZyb20gJy4vY21zL29yZGVyLW1hbmFnZW1lbnQtY29udHJvbGxlcidcbmltcG9ydCBQcm9kdWN0TWFuYWdlbWVudENvbnRyb2xsZXIgZnJvbSAnLi9jbXMvcHJvZHVjdC1tYW5hZ2VtZW50LWNvbnRyb2xsZXInXG5pbXBvcnQgUHJvbW90aW9uTWFuYWdlbWVudENvbnRyb2xsZXIgZnJvbSAnLi9jbXMvcHJvbW90aW9uLW1hbmFnZW1lbnQtY29udHJvbGxlcidcbmltcG9ydCBTdG9ja01hbmFnZW1lbnRDb250cm9sbGVyIGZyb20gJy4vY21zL3N0b2NrLW1hbmFnZW1lbnQtY29udHJvbGxlcidcbmltcG9ydCB7IFNpdGVEYXRhIH0gZnJvbSAnLi4vLi4vc2l0ZS1kZWZpbml0aW9ucydcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4uLy4uL2xpYnMvdXRpbHMnXG5pbXBvcnQgTG9jYWxTaG9wU2VydmljZSBmcm9tICcuLi9sb2NhbC1zaG9wLXNlcnZpY2VzL2xvY2FsLXNob3Atc2VydmljZSdcblxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKVxuXG5sZXQgbG9nID0gcmVxdWlyZSgnbnBtbG9nJylcblxuY29uc3QgVEFHID0gJ01haW5Db250cm9sbGVyJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDTVNDb250cm9sbGVyIGV4dGVuZHMgQmFzZUNvbnRyb2xsZXIge1xuICBjb25zdHJ1Y3RvciAoc2l0ZURhdGE6IFNpdGVEYXRhKSB7XG4gICAgc3VwZXIoT2JqZWN0LmFzc2lnbihzaXRlRGF0YSwgeyB2aWV3UGF0aDogcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uL3ZpZXdzJykgfSkpXG5cbiAgICBzdXBlci5yb3V0ZUdldCgnLycsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgcmVzLnJlZGlyZWN0KCcvY21zL29yZGVyLW1hbmFnZW1lbnQnKVxuICAgIH0pXG5cbiAgICBzdXBlci5yb3V0ZUdldCgnL3ByaWNlLWxpc3QnLCAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIExvY2FsU2hvcFNlcnZpY2UuZ2V0UHJvZHVjdHNCeUNhdGVnb3JpZXMoKS50aGVuKHJlc3AgPT4ge1xuICAgICAgICBpZiAocmVzcC5zdGF0dXMgJiYgcmVzcC5kYXRhKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVzcC5kYXRhLCBudWxsLCAyKSlcbiAgICAgICAgICByZXMubG9jYWxzLmxhc3RVcGRhdGVkID0gcmVzcC5kYXRhLmxhc3RVcGRhdGVkXG4gICAgICAgICAgcmVzLmxvY2Fscy5jYXRlZ29yaWVzID0gcmVzcC5kYXRhLmNhdGVnb3JpZXNcbiAgICAgICAgICByZXMucmVuZGVyKCdjbXMvcHJpY2UtbGlzdCcpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV4dChuZXcgRXJyb3IocmVzcC5lcnJNZXNzYWdlKSlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgc3VwZXIucm91dGVVc2UoJy9vcmRlci1tYW5hZ2VtZW50JywgbmV3IE9yZGVyTWFuYWdlbWVudENvbnRyb2xsZXIoc2l0ZURhdGEpLmdldFJvdXRlcigpKVxuICAgIHN1cGVyLnJvdXRlVXNlKCcvcHJvZHVjdC1tYW5hZ2VtZW50JywgbmV3IFByb2R1Y3RNYW5hZ2VtZW50Q29udHJvbGxlcihzaXRlRGF0YSkuZ2V0Um91dGVyKCkpXG4gICAgc3VwZXIucm91dGVVc2UoJy9wcm9tb3Rpb24tbWFuYWdlbWVudCcsIG5ldyBQcm9tb3Rpb25NYW5hZ2VtZW50Q29udHJvbGxlcihzaXRlRGF0YSkuZ2V0Um91dGVyKCkpXG4gICAgc3VwZXIucm91dGVVc2UoJy9zdG9jay1tYW5hZ2VtZW50JywgbmV3IFN0b2NrTWFuYWdlbWVudENvbnRyb2xsZXIoc2l0ZURhdGEpLmdldFJvdXRlcigpKVxuICB9XG59XG4iXX0=
