"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Promise=require("bluebird"),crud_service_1=require("../../services/crud-service"),local_shop_service_1=require("./local-shop-service"),shop_service_1=require("../../services/shop-service");class LocalStockService extends crud_service_1.default{getAisles(){return super.read("ShopAisle",{shopId:local_shop_service_1.default.getLocalShopId()})}createAisle(e){return super.create("ShopAisle",Object.assign({shopId:local_shop_service_1.default.getLocalShopId()},e))}updateAisle(e,s){return e?super.update("ShopAisle",s,{id:e}):Promise.resolve({status:!1,errMessage:"aisleId is required!"})}deleteAisle(e){return e?super.delete("ShopAisle",{id:e,shopId:local_shop_service_1.default.getLocalShopId()}):Promise.resolve({status:!1,errMessage:"aisleId is required!"})}getStocks(e){return shop_service_1.default.getShopStock(local_shop_service_1.default.getLocalShopId(),{variantId:e})}getStocksGroupedByAisle(e){return super.rawReadQuery(`SELECT * FROM shopStocksView WHERE shopId=${local_shop_service_1.default.getLocalShopId()} AND variantId=${e} AND quantity > 0`)}addShopStock(e){const{variantId:s,price:r,quantity:t,aisle:o,date:i,description:a}=e;return a?this.create("ShopStock",{shopId:local_shop_service_1.default.getLocalShopId(),variantId:s,price:r,quantity:t,aisle:o,date:i,description:a}):Promise.resolve({status:!1,errMessage:"Description is required!"})}}exports.default=new LocalStockService;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAvbG9jYWwtc2hvcC1zZXJ2aWNlcy9zdG9jay1zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbIlByb21pc2UiLCJyZXF1aXJlIiwiY3J1ZF9zZXJ2aWNlXzEiLCJsb2NhbF9zaG9wX3NlcnZpY2VfMSIsInNob3Bfc2VydmljZV8xIiwiTG9jYWxTdG9ja1NlcnZpY2UiLCJkZWZhdWx0IiwiW29iamVjdCBPYmplY3RdIiwic3VwZXIiLCJyZWFkIiwic2hvcElkIiwiZ2V0TG9jYWxTaG9wSWQiLCJkYXRhIiwiY3JlYXRlIiwiT2JqZWN0IiwiYXNzaWduIiwiYWlzbGVJZCIsInVwZGF0ZSIsImlkIiwicmVzb2x2ZSIsInN0YXR1cyIsImVyck1lc3NhZ2UiLCJkZWxldGUiLCJ2YXJpYW50SWQiLCJnZXRTaG9wU3RvY2siLCJyYXdSZWFkUXVlcnkiLCJwcmljZSIsInF1YW50aXR5IiwiYWlzbGUiLCJkYXRlIiwiZGVzY3JpcHRpb24iLCJ0aGlzIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Im9FQUVBLE1BQUFBLFFBQUFDLFFBQUEsWUFLQUMsZUFBQUQsUUFBQSwrQkFDQUUscUJBQUFGLFFBQUEsd0JBQ0FHLGVBQUFILFFBQUEscUNBVUFJLDBCQUFnQ0gsZUFBQUksUUFDOUJDLFlBQ0UsT0FBT0MsTUFBTUMsS0FBWSxhQUFlQyxPQUFRUCxxQkFBQUcsUUFBaUJLLG1CQUduRUosWUFBYUssR0FDWCxPQUFPSixNQUFNSyxPQUFjLFlBQVdDLE9BQUFDLFFBQUlMLE9BQVFQLHFCQUFBRyxRQUFpQkssa0JBQXFCQyxJQUcxRkwsWUFBYVMsRUFBaUJKLEdBQzVCLE9BQUlJLEVBQ0tSLE1BQU1TLE9BQWMsWUFBYUwsR0FBUU0sR0FBSUYsSUFFN0NoQixRQUFRbUIsU0FBVUMsUUFBUSxFQUFPQyxXQUFZLHlCQUl4RGQsWUFBYVMsR0FDWCxPQUFJQSxFQUNLUixNQUFNYyxPQUFjLGFBQWVKLEdBQUlGLEVBQVNOLE9BQVFQLHFCQUFBRyxRQUFpQkssbUJBRXpFWCxRQUFRbUIsU0FBVUMsUUFBUSxFQUFPQyxXQUFZLHlCQUl4RGQsVUFBV2dCLEdBQ1QsT0FBT25CLGVBQUFFLFFBQVlrQixhQUFhckIscUJBQUFHLFFBQWlCSyxrQkFBb0JZLFVBQUFBLElBR3ZFaEIsd0JBQXlCZ0IsR0FDdkIsT0FBT2YsTUFBTWlCLDBEQUEwRHRCLHFCQUFBRyxRQUFpQkssa0NBQWtDWSxzQkFHNUhoQixhQUFjSyxHQUNaLE1BQU1XLFVBQUVBLEVBQVNHLE1BQUVBLEVBQUtDLFNBQUVBLEVBQVFDLE1BQUVBLEVBQUtDLEtBQUVBLEVBQUlDLFlBQUVBLEdBQWdCbEIsRUFDakUsT0FBS2tCLEVBR0lDLEtBQUtsQixPQUFrQixhQUM1QkgsT0FBUVAscUJBQUFHLFFBQWlCSyxpQkFDekJZLFVBQUFBLEVBQ0FHLE1BQUFBLEVBQ0FDLFNBQUFBLEVBQ0FDLE1BQUFBLEVBQ0FDLEtBQUFBLEVBQ0FDLFlBQUFBLElBVEs5QixRQUFRbUIsU0FBVUMsUUFBUSxFQUFPQyxXQUFZLDhCQWdCMURXLFFBQUExQixRQUFlLElBQUlEIiwiZmlsZSI6ImFwcC9sb2NhbC1zaG9wLXNlcnZpY2VzL3N0b2NrLXNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyB1dGlsIGZyb20gJ3V0aWwnXG5cbmltcG9ydCAqIGFzIFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5pbXBvcnQgeyBNb2RlbCB9IGZyb20gJ3NlcXVlbGl6ZSdcbmltcG9ydCAqIGFzIG1vbWVudCBmcm9tICdtb21lbnQnXG5cbmltcG9ydCBBcHBDb25maWcgZnJvbSAnLi4vLi4vYXBwLWNvbmZpZydcbmltcG9ydCBDUlVEU2VydmljZSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9jcnVkLXNlcnZpY2UnXG5pbXBvcnQgTG9jYWxTaG9wU2VydmljZSBmcm9tICcuL2xvY2FsLXNob3Atc2VydmljZSdcbmltcG9ydCBTaG9wU2VydmljZSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9zaG9wLXNlcnZpY2UnXG5pbXBvcnQgUHJpbnRTZXJ2aWNlIGZyb20gJy4uLy4uL3NlcnZpY2VzL3ByaW50LXNlcnZpY2UnXG5cbi8qXG4gIFVzZWQgZm9yIHNob3Atc3BlY2lmaWMgY29kZS4gVGhpcyBzaG91bGQgcmUtdXNlIHdoYXQncyBpbiBzaG9wLXNlcnZpY2UgYXMgbXVjaCBhcyBwb3NzaWJsZSwgdGhvdWdoLlxuXG4gIFRPRE86XG4gIDEuIFVwZGF0ZSBvcmRlckhpc3RvcmllcyB3aGVuZXZlciBhbiB1cGRhdGUgaXMgbWFkZSB0byBvcmRlciB0YWJsZSwgc28gdGhhdCB3ZSBoYXZlIGJldHRlciBpZGVhcyB3aGVuXG4gICAgIGEgcHJvYmxlbSBoYXBwZW5zXG4gKi9cbmNsYXNzIExvY2FsU3RvY2tTZXJ2aWNlIGV4dGVuZHMgQ1JVRFNlcnZpY2Uge1xuICBnZXRBaXNsZXMgKCk6IFByb21pc2U8TkNSZXNwb25zZTxBaXNsZVtdPj4ge1xuICAgIHJldHVybiBzdXBlci5yZWFkPEFpc2xlPignU2hvcEFpc2xlJywgeyBzaG9wSWQ6IExvY2FsU2hvcFNlcnZpY2UuZ2V0TG9jYWxTaG9wSWQoKSB9KVxuICB9XG5cbiAgY3JlYXRlQWlzbGUgKGRhdGE6IFBhcnRpYWw8QWlzbGU+KTogUHJvbWlzZTxOQ1Jlc3BvbnNlPEFpc2xlPj4ge1xuICAgIHJldHVybiBzdXBlci5jcmVhdGU8QWlzbGU+KCdTaG9wQWlzbGUnLCB7IHNob3BJZDogTG9jYWxTaG9wU2VydmljZS5nZXRMb2NhbFNob3BJZCgpLCAuLi5kYXRhIH0pXG4gIH1cblxuICB1cGRhdGVBaXNsZSAoYWlzbGVJZDogbnVtYmVyLCBkYXRhOiBQYXJ0aWFsPEFpc2xlPik6IFByb21pc2U8TkNSZXNwb25zZTxudW1iZXI+PiB7XG4gICAgaWYgKGFpc2xlSWQpIHtcbiAgICAgIHJldHVybiBzdXBlci51cGRhdGU8QWlzbGU+KCdTaG9wQWlzbGUnLCBkYXRhLCB7IGlkOiBhaXNsZUlkIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyBzdGF0dXM6IGZhbHNlLCBlcnJNZXNzYWdlOiAnYWlzbGVJZCBpcyByZXF1aXJlZCEnIH0pXG4gICAgfVxuICB9XG5cbiAgZGVsZXRlQWlzbGUgKGFpc2xlSWQ6IG51bWJlcik6IFByb21pc2U8TkNSZXNwb25zZTxudW1iZXI+PiB7XG4gICAgaWYgKGFpc2xlSWQpIHtcbiAgICAgIHJldHVybiBzdXBlci5kZWxldGU8QWlzbGU+KCdTaG9wQWlzbGUnLCB7IGlkOiBhaXNsZUlkLCBzaG9wSWQ6IExvY2FsU2hvcFNlcnZpY2UuZ2V0TG9jYWxTaG9wSWQoKSB9KVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHsgc3RhdHVzOiBmYWxzZSwgZXJyTWVzc2FnZTogJ2Fpc2xlSWQgaXMgcmVxdWlyZWQhJyB9KVxuICAgIH1cbiAgfVxuXG4gIGdldFN0b2NrcyAodmFyaWFudElkOiBudW1iZXIpIHtcbiAgICByZXR1cm4gU2hvcFNlcnZpY2UuZ2V0U2hvcFN0b2NrKExvY2FsU2hvcFNlcnZpY2UuZ2V0TG9jYWxTaG9wSWQoKSwgeyB2YXJpYW50SWQgfSlcbiAgfVxuXG4gIGdldFN0b2Nrc0dyb3VwZWRCeUFpc2xlICh2YXJpYW50SWQ6IG51bWJlcik6IFByb21pc2U8TkNSZXNwb25zZTxTaG9wU3RvY2tbXT4+IHtcbiAgICByZXR1cm4gc3VwZXIucmF3UmVhZFF1ZXJ5KGBTRUxFQ1QgKiBGUk9NIHNob3BTdG9ja3NWaWV3IFdIRVJFIHNob3BJZD0ke0xvY2FsU2hvcFNlcnZpY2UuZ2V0TG9jYWxTaG9wSWQoKX0gQU5EIHZhcmlhbnRJZD0ke3ZhcmlhbnRJZH0gQU5EIHF1YW50aXR5ID4gMGApXG4gIH1cblxuICBhZGRTaG9wU3RvY2sgKGRhdGE6IFBhcnRpYWw8U2hvcFN0b2NrPik6IFByb21pc2U8TkNSZXNwb25zZTxTaG9wU3RvY2s+PiB7XG4gICAgY29uc3QgeyB2YXJpYW50SWQsIHByaWNlLCBxdWFudGl0eSwgYWlzbGUsIGRhdGUsIGRlc2NyaXB0aW9uIH0gPSBkYXRhXG4gICAgaWYgKCFkZXNjcmlwdGlvbikge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7IHN0YXR1czogZmFsc2UsIGVyck1lc3NhZ2U6ICdEZXNjcmlwdGlvbiBpcyByZXF1aXJlZCEnIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZTxTaG9wU3RvY2s+KCdTaG9wU3RvY2snLCB7XG4gICAgICAgIHNob3BJZDogTG9jYWxTaG9wU2VydmljZS5nZXRMb2NhbFNob3BJZCgpLFxuICAgICAgICB2YXJpYW50SWQsXG4gICAgICAgIHByaWNlLFxuICAgICAgICBxdWFudGl0eSxcbiAgICAgICAgYWlzbGUsXG4gICAgICAgIGRhdGUsXG4gICAgICAgIGRlc2NyaXB0aW9uXG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBMb2NhbFN0b2NrU2VydmljZSgpXG4iXX0=
