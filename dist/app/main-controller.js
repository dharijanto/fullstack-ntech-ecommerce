"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_controller_1=require("./controllers/base-controller"),product_service_1=require("../services/product-service"),sequelize_service_1=require("../services/sequelize-service"),path=require("path");var log=require("npmlog"),CredentialController=require(path.join(__dirname,"controllers/credential-controller"));const TAG="MainController";class Controller extends base_controller_1.default{constructor(e){super(Object.assign(e,{viewPath:path.join(__dirname,"views")})),sequelize_service_1.default.initialize(e.db.sequelize,e.db.models),this.addInterceptor((e,r,t)=>{log.verbose(TAG,"req.path="+e.path),log.verbose(TAG,"loggedIn="+e.isAuthenticated()),log.verbose(TAG,"req.on="+JSON.stringify(e.session)),t()}),this.routeGet("/",(e,r,t)=>{product_service_1.default.getCategories().then(e=>{log.verbose(TAG,"resp="+JSON.stringify(e)),e.status}),r.render("index")})}}module.exports=Controller;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAvbWFpbi1jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbImJhc2VfY29udHJvbGxlcl8xIiwicmVxdWlyZSIsInByb2R1Y3Rfc2VydmljZV8xIiwic2VxdWVsaXplX3NlcnZpY2VfMSIsInBhdGgiLCJsb2ciLCJDcmVkZW50aWFsQ29udHJvbGxlciIsImpvaW4iLCJfX2Rpcm5hbWUiLCJUQUciLCJDb250cm9sbGVyIiwiZGVmYXVsdCIsIltvYmplY3QgT2JqZWN0XSIsInNpdGVEYXRhIiwic3VwZXIiLCJPYmplY3QiLCJhc3NpZ24iLCJ2aWV3UGF0aCIsImluaXRpYWxpemUiLCJkYiIsInNlcXVlbGl6ZSIsIm1vZGVscyIsInRoaXMiLCJhZGRJbnRlcmNlcHRvciIsInJlcSIsInJlcyIsIm5leHQiLCJ2ZXJib3NlIiwiaXNBdXRoZW50aWNhdGVkIiwiSlNPTiIsInN0cmluZ2lmeSIsInNlc3Npb24iLCJyb3V0ZUdldCIsImdldENhdGVnb3JpZXMiLCJ0aGVuIiwicmVzcCIsInN0YXR1cyIsInJlbmRlciIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJvRUFBQSxNQUFBQSxrQkFBQUMsUUFBQSxpQ0FDQUMsa0JBQUFELFFBQUEsK0JBQ0FFLG9CQUFBRixRQUFBLGlDQUdNRyxLQUFPSCxRQUFRLFFBRXJCLElBQUlJLElBQU1KLFFBQVEsVUFFZEsscUJBQXVCTCxRQUFRRyxLQUFLRyxLQUFLQyxVQUFXLHNDQUV4RCxNQUFNQyxJQUFNLHVCQUVaQyxtQkFBeUJWLGtCQUFBVyxRQUN2QkMsWUFBYUMsR0FDWEMsTUFBTUMsT0FBT0MsT0FBT0gsR0FBV0ksU0FBVWIsS0FBS0csS0FBS0MsVUFBVyxZQUM5REwsb0JBQUFRLFFBQWlCTyxXQUFXTCxFQUFTTSxHQUFHQyxVQUFXUCxFQUFTTSxHQUFHRSxRQUUvREMsS0FBS0MsZUFBZSxDQUFDQyxFQUFLQyxFQUFLQyxLQUM3QnJCLElBQUlzQixRQUFRbEIsSUFBSyxZQUFjZSxFQUFJcEIsTUFDbkNDLElBQUlzQixRQUFRbEIsSUFBSyxZQUFjZSxFQUFJSSxtQkFDbkN2QixJQUFJc0IsUUFBUWxCLElBQUssVUFBWW9CLEtBQUtDLFVBQVVOLEVBQUlPLFVBQ2hETCxNQUdGSixLQUFLVSxTQUFTLElBQUssQ0FBQ1IsRUFBS0MsRUFBS0MsS0FDNUJ4QixrQkFBQVMsUUFBZXNCLGdCQUFnQkMsS0FBS0MsSUFDbEM5QixJQUFJc0IsUUFBUWxCLElBQUssUUFBVW9CLEtBQUtDLFVBQVVLLElBQ3RDQSxFQUFLQyxTQUlYWCxFQUFJWSxPQUFPLFlBT2pCQyxPQUFPQyxRQUFVN0IiLCJmaWxlIjoiYXBwL21haW4tY29udHJvbGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCYXNlQ29udHJvbGxlciBmcm9tICcuL2NvbnRyb2xsZXJzL2Jhc2UtY29udHJvbGxlcidcbmltcG9ydCBQcm9kdWN0U2VydmljZSBmcm9tICcuLi9zZXJ2aWNlcy9wcm9kdWN0LXNlcnZpY2UnXG5pbXBvcnQgU2VxdWVsaXplU2VydmljZSBmcm9tICcuLi9zZXJ2aWNlcy9zZXF1ZWxpemUtc2VydmljZSc7XG5pbXBvcnQgeyBTaXRlRGF0YSB9IGZyb20gJy4uL3NpdGUtZGVmaW5pdGlvbnMnO1xuXG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpXG5cbnZhciBsb2cgPSByZXF1aXJlKCducG1sb2cnKVxuXG52YXIgQ3JlZGVudGlhbENvbnRyb2xsZXIgPSByZXF1aXJlKHBhdGguam9pbihfX2Rpcm5hbWUsICdjb250cm9sbGVycy9jcmVkZW50aWFsLWNvbnRyb2xsZXInKSlcblxuY29uc3QgVEFHID0gJ01haW5Db250cm9sbGVyJ1xuXG5jbGFzcyBDb250cm9sbGVyIGV4dGVuZHMgQmFzZUNvbnRyb2xsZXIge1xuICBjb25zdHJ1Y3RvciAoc2l0ZURhdGE6IFNpdGVEYXRhKSB7XG4gICAgc3VwZXIoT2JqZWN0LmFzc2lnbihzaXRlRGF0YSwge3ZpZXdQYXRoOiBwYXRoLmpvaW4oX19kaXJuYW1lLCAndmlld3MnKX0pKVxuICAgIFNlcXVlbGl6ZVNlcnZpY2UuaW5pdGlhbGl6ZShzaXRlRGF0YS5kYi5zZXF1ZWxpemUsIHNpdGVEYXRhLmRiLm1vZGVscylcblxuICAgIHRoaXMuYWRkSW50ZXJjZXB0b3IoKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBsb2cudmVyYm9zZShUQUcsICdyZXEucGF0aD0nICsgcmVxLnBhdGgpXG4gICAgICBsb2cudmVyYm9zZShUQUcsICdsb2dnZWRJbj0nICsgcmVxLmlzQXV0aGVudGljYXRlZCgpKVxuICAgICAgbG9nLnZlcmJvc2UoVEFHLCAncmVxLm9uPScgKyBKU09OLnN0cmluZ2lmeShyZXEuc2Vzc2lvbikpXG4gICAgICBuZXh0KClcbiAgICB9KVxuXG4gICAgdGhpcy5yb3V0ZUdldCgnLycsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgUHJvZHVjdFNlcnZpY2UuZ2V0Q2F0ZWdvcmllcygpLnRoZW4ocmVzcCA9PiB7XG4gICAgICAgIGxvZy52ZXJib3NlKFRBRywgJ3Jlc3A9JyArIEpTT04uc3RyaW5naWZ5KHJlc3ApKVxuICAgICAgICBpZiAocmVzcC5zdGF0dXMpIHtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJlcy5yZW5kZXIoJ2luZGV4JylcbiAgICB9KVxuXG4gICAgLyogdGhpcy5yb3V0ZVVzZSgobmV3IENyZWRlbnRpYWxDb250cm9sbGVyKGluaXREYXRhKSkuZ2V0Um91dGVyKCkpICovXG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBDb250cm9sbGVyXG4iXX0=
