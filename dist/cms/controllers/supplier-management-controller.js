"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_controller_1=require("./base-controller"),shop_service_1=require("../../services/shop-service");let log=require("npmlog");const TAG="ProductManagementController";class SupplierManagementController extends base_controller_1.default{constructor(e){super(e,!1),super.routeGet("/",(e,r,s)=>{r.render("supplier-management")}),super.routeGet("/suppliers",(e,r,s)=>{shop_service_1.default.read("Supplier",{}).then(r.json.bind(r)).catch(s)}),super.routePost("/supplier",(e,r,s)=>{shop_service_1.default.create("Supplier",e.body).then(r.json.bind(r)).catch(s)}),super.routePost("/supplier/edit",(e,r,s)=>{shop_service_1.default.update("Supplier",e.body,{id:e.body.id}).then(r.json.bind(r)).catch(s)}),super.routePost("/supplier/delete",(e,r,s)=>{shop_service_1.default.delete("Supplier",{id:e.body.id}).then(r.json.bind(r)).catch(s)}),super.routeGet("/supplier-stocks",(e,r,s)=>{const t=e.query.supplierId;t?shop_service_1.default.getSupplierStock(t).then(e=>{r.json(e)}).catch(s):r.send({status:!1,errMessage:"supplierId is required"})}),super.routePost("/supplier-stock",(e,r,s)=>{const t=e.query.variantId,o=e.query.supplierId;t&&o?shop_service_1.default.addSupplierStock(Object.assign({supplierId:o,variantId:t},e.body)).then(r.json.bind(r)).catch(s):r.json({status:!1,errMessage:"variantId and supplierId are requried"})}),super.routePost("/supplier-stock/edit",(e,r,s)=>{shop_service_1.default.update("SupplierStock",e.body,{id:e.body.id}).then(e=>{r.json(e)}).catch(s)}),super.routePost("/supplier-stock/delete",(e,r,s)=>{shop_service_1.default.delete("SupplierStock",{id:e.body.id}).then(e=>{r.json(e)}).catch(s)})}}exports.default=SupplierManagementController;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jbXMvY29udHJvbGxlcnMvc3VwcGxpZXItbWFuYWdlbWVudC1jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbImJhc2VfY29udHJvbGxlcl8xIiwicmVxdWlyZSIsInNob3Bfc2VydmljZV8xIiwibG9nIiwiVEFHIiwiU3VwcGxpZXJNYW5hZ2VtZW50Q29udHJvbGxlciIsImRlZmF1bHQiLCJbb2JqZWN0IE9iamVjdF0iLCJpbml0RGF0YSIsInN1cGVyIiwicm91dGVHZXQiLCJyZXEiLCJyZXMiLCJuZXh0IiwicmVuZGVyIiwicmVhZCIsInRoZW4iLCJqc29uIiwiYmluZCIsImNhdGNoIiwicm91dGVQb3N0IiwiY3JlYXRlIiwiYm9keSIsInVwZGF0ZSIsImlkIiwiZGVsZXRlIiwic3VwcGxpZXJJZCIsInF1ZXJ5IiwiZ2V0U3VwcGxpZXJTdG9jayIsInJlc3AiLCJzZW5kIiwic3RhdHVzIiwiZXJyTWVzc2FnZSIsInZhcmlhbnRJZCIsImFkZFN1cHBsaWVyU3RvY2siLCJPYmplY3QiLCJhc3NpZ24iLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoib0VBQ0EsTUFBQUEsa0JBQUFDLFFBQUEscUJBS0FDLGVBQUFELFFBQUEsK0JBRUEsSUFBSUUsSUFBTUYsUUFBUSxVQUVsQixNQUFNRyxJQUFNLG9DQUNaQyxxQ0FBMERMLGtCQUFBTSxRQUN4REMsWUFBYUMsR0FDWEMsTUFBTUQsR0FBVSxHQUNoQkMsTUFBTUMsU0FBUyxJQUFLLENBQUNDLEVBQUtDLEVBQUtDLEtBQzdCRCxFQUFJRSxPQUFPLHlCQUdiTCxNQUFNQyxTQUFTLGFBQWMsQ0FBQ0MsRUFBS0MsRUFBS0MsS0FDdENYLGVBQUFJLFFBQVlTLEtBQWUsZUFBZ0JDLEtBQUtKLEVBQUlLLEtBQUtDLEtBQUtOLElBQU1PLE1BQU1OLEtBRzVFSixNQUFNVyxVQUFVLFlBQWEsQ0FBQ1QsRUFBS0MsRUFBS0MsS0FDdENYLGVBQUFJLFFBQVllLE9BQWlCLFdBQVlWLEVBQUlXLE1BQU1OLEtBQUtKLEVBQUlLLEtBQUtDLEtBQUtOLElBQU1PLE1BQU1OLEtBR3BGSixNQUFNVyxVQUFVLGlCQUFrQixDQUFDVCxFQUFLQyxFQUFLQyxLQUMzQ1gsZUFBQUksUUFBWWlCLE9BQWlCLFdBQVlaLEVBQUlXLE1BQVFFLEdBQUliLEVBQUlXLEtBQUtFLEtBQU1SLEtBQUtKLEVBQUlLLEtBQUtDLEtBQUtOLElBQU1PLE1BQU1OLEtBR3pHSixNQUFNVyxVQUFVLG1CQUFvQixDQUFDVCxFQUFLQyxFQUFLQyxLQUM3Q1gsZUFBQUksUUFBWW1CLE9BQWlCLFlBQWNELEdBQUliLEVBQUlXLEtBQUtFLEtBQU1SLEtBQUtKLEVBQUlLLEtBQUtDLEtBQUtOLElBQU1PLE1BQU1OLEtBRy9GSixNQUFNQyxTQUFTLG1CQUFvQixDQUFDQyxFQUFLQyxFQUFLQyxLQUM1QyxNQUFNYSxFQUFhZixFQUFJZ0IsTUFBTUQsV0FDeEJBLEVBR0h4QixlQUFBSSxRQUFZc0IsaUJBQWlCRixHQUFZVixLQUFLYSxJQUM1Q2pCLEVBQUlLLEtBQUtZLEtBQ1JWLE1BQU1OLEdBSlRELEVBQUlrQixNQUFPQyxRQUFRLEVBQU9DLFdBQVksNkJBUTFDdkIsTUFBTVcsVUFBVSxrQkFBbUIsQ0FBQ1QsRUFBS0MsRUFBS0MsS0FDNUMsTUFBTW9CLEVBQVl0QixFQUFJZ0IsTUFBTU0sVUFDdEJQLEVBQWFmLEVBQUlnQixNQUFNRCxXQUN4Qk8sR0FBY1AsRUFHakJ4QixlQUFBSSxRQUFZNEIsaUJBQWlCQyxPQUFPQyxRQUFTVixXQUFBQSxFQUFZTyxVQUFBQSxHQUFhdEIsRUFBSVcsT0FBT04sS0FBS0osRUFBSUssS0FBS0MsS0FBS04sSUFBTU8sTUFBTU4sR0FGaEhELEVBQUlLLE1BQU9jLFFBQVEsRUFBT0MsV0FBWSw0Q0FNMUN2QixNQUFNVyxVQUFVLHVCQUF3QixDQUFDVCxFQUFLQyxFQUFLQyxLQUNqRFgsZUFBQUksUUFBWWlCLE9BQXNCLGdCQUFpQlosRUFBSVcsTUFBUUUsR0FBSWIsRUFBSVcsS0FBS0UsS0FBTVIsS0FBS2EsSUFDckZqQixFQUFJSyxLQUFLWSxLQUNSVixNQUFNTixLQUdYSixNQUFNVyxVQUFVLHlCQUEwQixDQUFDVCxFQUFLQyxFQUFLQyxLQUNuRFgsZUFBQUksUUFBWW1CLE9BQXNCLGlCQUFtQkQsR0FBS2IsRUFBSVcsS0FBS0UsS0FBTVIsS0FBS2EsSUFDNUVqQixFQUFJSyxLQUFLWSxLQUNSVixNQUFNTixNQXJEZndCLFFBQUEvQixRQUFBRCIsImZpbGUiOiJjbXMvY29udHJvbGxlcnMvc3VwcGxpZXItbWFuYWdlbWVudC1jb250cm9sbGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IEJhc2VDb250cm9sbGVyIGZyb20gJy4vYmFzZS1jb250cm9sbGVyJ1xuaW1wb3J0IFByb2R1Y3RTZXJ2aWNlIGZyb20gJy4uLy4uL3NlcnZpY2VzL3Byb2R1Y3Qtc2VydmljZSdcbmltcG9ydCB7IEltYWdlU2VydmljZSB9IGZyb20gJy4uLy4uL3NpdGUtZGVmaW5pdGlvbnMnXG5cbmltcG9ydCBBcHBDb25maWcgZnJvbSAnLi4vLi4vYXBwLWNvbmZpZydcbmltcG9ydCBTaG9wU2VydmljZSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9zaG9wLXNlcnZpY2UnXG5cbmxldCBsb2cgPSByZXF1aXJlKCducG1sb2cnKVxuXG5jb25zdCBUQUcgPSAnUHJvZHVjdE1hbmFnZW1lbnRDb250cm9sbGVyJ1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3VwcGxpZXJNYW5hZ2VtZW50Q29udHJvbGxlciBleHRlbmRzIEJhc2VDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IgKGluaXREYXRhKSB7XG4gICAgc3VwZXIoaW5pdERhdGEsIGZhbHNlKVxuICAgIHN1cGVyLnJvdXRlR2V0KCcvJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICByZXMucmVuZGVyKCdzdXBwbGllci1tYW5hZ2VtZW50JylcbiAgICB9KVxuXG4gICAgc3VwZXIucm91dGVHZXQoJy9zdXBwbGllcnMnLCAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIFNob3BTZXJ2aWNlLnJlYWQ8U3VwcGxpZXI+KCdTdXBwbGllcicsIHt9KS50aGVuKHJlcy5qc29uLmJpbmQocmVzKSkuY2F0Y2gobmV4dClcbiAgICB9KVxuXG4gICAgc3VwZXIucm91dGVQb3N0KCcvc3VwcGxpZXInLCAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIFNob3BTZXJ2aWNlLmNyZWF0ZTxTdXBwbGllcj4oJ1N1cHBsaWVyJywgcmVxLmJvZHkpLnRoZW4ocmVzLmpzb24uYmluZChyZXMpKS5jYXRjaChuZXh0KVxuICAgIH0pXG5cbiAgICBzdXBlci5yb3V0ZVBvc3QoJy9zdXBwbGllci9lZGl0JywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBTaG9wU2VydmljZS51cGRhdGU8U3VwcGxpZXI+KCdTdXBwbGllcicsIHJlcS5ib2R5LCB7IGlkOiByZXEuYm9keS5pZCB9KS50aGVuKHJlcy5qc29uLmJpbmQocmVzKSkuY2F0Y2gobmV4dClcbiAgICB9KVxuXG4gICAgc3VwZXIucm91dGVQb3N0KCcvc3VwcGxpZXIvZGVsZXRlJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBTaG9wU2VydmljZS5kZWxldGU8U3VwcGxpZXI+KCdTdXBwbGllcicsIHsgaWQ6IHJlcS5ib2R5LmlkIH0pLnRoZW4ocmVzLmpzb24uYmluZChyZXMpKS5jYXRjaChuZXh0KVxuICAgIH0pXG5cbiAgICBzdXBlci5yb3V0ZUdldCgnL3N1cHBsaWVyLXN0b2NrcycsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgY29uc3Qgc3VwcGxpZXJJZCA9IHJlcS5xdWVyeS5zdXBwbGllcklkXG4gICAgICBpZiAoIXN1cHBsaWVySWQpIHtcbiAgICAgICAgcmVzLnNlbmQoeyBzdGF0dXM6IGZhbHNlLCBlcnJNZXNzYWdlOiAnc3VwcGxpZXJJZCBpcyByZXF1aXJlZCcgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFNob3BTZXJ2aWNlLmdldFN1cHBsaWVyU3RvY2soc3VwcGxpZXJJZCkudGhlbihyZXNwID0+IHtcbiAgICAgICAgICByZXMuanNvbihyZXNwKVxuICAgICAgICB9KS5jYXRjaChuZXh0KVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBzdXBlci5yb3V0ZVBvc3QoJy9zdXBwbGllci1zdG9jaycsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgY29uc3QgdmFyaWFudElkID0gcmVxLnF1ZXJ5LnZhcmlhbnRJZFxuICAgICAgY29uc3Qgc3VwcGxpZXJJZCA9IHJlcS5xdWVyeS5zdXBwbGllcklkXG4gICAgICBpZiAoIXZhcmlhbnRJZCB8fCAhc3VwcGxpZXJJZCkge1xuICAgICAgICByZXMuanNvbih7IHN0YXR1czogZmFsc2UsIGVyck1lc3NhZ2U6ICd2YXJpYW50SWQgYW5kIHN1cHBsaWVySWQgYXJlIHJlcXVyaWVkJyB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgU2hvcFNlcnZpY2UuYWRkU3VwcGxpZXJTdG9jayhPYmplY3QuYXNzaWduKHsgc3VwcGxpZXJJZCwgdmFyaWFudElkIH0sIHJlcS5ib2R5KSkudGhlbihyZXMuanNvbi5iaW5kKHJlcykpLmNhdGNoKG5leHQpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHN1cGVyLnJvdXRlUG9zdCgnL3N1cHBsaWVyLXN0b2NrL2VkaXQnLCAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIFNob3BTZXJ2aWNlLnVwZGF0ZTxTdXBwbGllclN0b2NrPignU3VwcGxpZXJTdG9jaycsIHJlcS5ib2R5LCB7IGlkOiByZXEuYm9keS5pZCB9KS50aGVuKHJlc3AgPT4ge1xuICAgICAgICByZXMuanNvbihyZXNwKVxuICAgICAgfSkuY2F0Y2gobmV4dClcbiAgICB9KVxuXG4gICAgc3VwZXIucm91dGVQb3N0KCcvc3VwcGxpZXItc3RvY2svZGVsZXRlJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBTaG9wU2VydmljZS5kZWxldGU8U3VwcGxpZXJTdG9jaz4oJ1N1cHBsaWVyU3RvY2snLCB7IGlkIDogcmVxLmJvZHkuaWQgfSkudGhlbihyZXNwID0+IHtcbiAgICAgICAgcmVzLmpzb24ocmVzcClcbiAgICAgIH0pLmNhdGNoKG5leHQpXG4gICAgfSlcbiAgfVxufVxuIl19
